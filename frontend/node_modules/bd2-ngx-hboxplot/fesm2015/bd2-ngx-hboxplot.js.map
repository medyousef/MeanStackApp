{"version":3,"file":"bd2-ngx-hboxplot.js","sources":["../../../projects/bd2-ngx-hboxplot/src/lib/d3service/d3.service.ts","../../../projects/bd2-ngx-hboxplot/src/lib/d3service/index.ts","../../../projects/bd2-ngx-hboxplot/src/lib/hbox-plot/hbox-plot.dom.ts","../../../projects/bd2-ngx-hboxplot/src/lib/hbox-utils/box-dom.ts","../../../projects/bd2-ngx-hboxplot/src/lib/hbox-utils/box-util.ts","../../../projects/bd2-ngx-hboxplot/src/lib/hbox-utils/color-palette.ts","../../../projects/bd2-ngx-hboxplot/src/lib/hbox-utils/smart-rounding.ts","../../../projects/bd2-ngx-hboxplot/src/lib/hbox-plot/hbox-plot.component.ts","../../../projects/bd2-ngx-hboxplot/src/lib/bd2-ngx-hboxplot.module.ts","../../../projects/bd2-ngx-hboxplot/src/public-api.ts","../../../projects/bd2-ngx-hboxplot/src/bd2-ngx-hboxplot.ts"],"sourcesContent":["import * as d3lib from 'd3';\r\n\r\nexport type D3 = typeof d3lib;\r\nexport const d3 = d3lib;\r\n\r\n/**\r\n D3 integration was originally based on the code for npm library: d3-ng2-service\r\n by Tom Wanzek, https://github.com/tomwanzek/d3-ng2-service.\r\n\r\n That package was used during developement and then converted into inline service\r\n to reduce the dependencies and boundle size.\r\n\r\n At some point, I moved to to simpler dependency on d3:\r\n npm install --save d3\r\n npm install --save-dev @types/d3\r\n\r\n and removed the parts from d3-modules.ts as they were causing errors\r\n (not sure how to fix them and also one dependency is easier to maintain).\r\n */\r\n","export * from './d3.service';\r\n\r\n/*\r\n// that has been removed after importing a single d3 dependency\r\n\r\nexport {\r\n  // d3-array\r\n  Bin,\r\n  Bisector,\r\n  HistogramGenerator,\r\n  Numeric,\r\n  ThresholdArrayGenerator,\r\n  ThresholdCountGenerator,\r\n  // d3-axis\r\n  Axis,\r\n  AxisContainerElement,\r\n  AxisScale,\r\n  AxisTimeInterval,\r\n  // d3-scale\r\n  InterpolatorFactory,\r\n  ScaleBand,\r\n  ScaleIdentity,\r\n  ScaleLinear,\r\n  ScaleLogarithmic,\r\n  ScaleOrdinal,\r\n  ScalePoint,\r\n  ScalePower,\r\n  ScaleQuantile,\r\n  ScaleQuantize,\r\n  ScaleSequential,\r\n  ScaleThreshold,\r\n  ScaleTime,\r\n\r\n  // d3-selection\r\n  ArrayLike,\r\n  BaseEvent,\r\n  BaseType,\r\n  ContainerElement,\r\n  EnterElement,\r\n  Local,\r\n  NamespaceLocalObject,\r\n  NamespaceMap,\r\n  Selection,\r\n  SelectionFn,\r\n  TransitionLike,\r\n  ValueFn,\r\n  // d3-selection-multi\r\n  ValueMap,\r\n  // d3-shape\r\n  Arc,\r\n  Area,\r\n  DefaultArcObject,\r\n  Line,\r\n  Pie,\r\n  PieArcDatum,\r\n  RadialArea,\r\n  RadialLine,\r\n  Series,\r\n  SeriesPoint,\r\n  Stack,\r\n  Symbol,\r\n  SymbolType,\r\n  // d3-transition\r\n  Transition\r\n} from './d3-modules';\r\n\r\n\r\n */\r\n","// import {Transition} from 'd3-transition';\nimport {Axis} from 'd3-axis';\nimport {ScaleBand, ScaleLinear} from 'd3-scale';\nimport {Selection, Transition} from 'd3';\n\n\nexport class LookAndFeel {\n\n  vMargin = 25;\n  hMarginL = 20;\n  hMarginR = 15;\n  rowWidth = 30;\n  rowGap = 0.2;\n\n  transitionTime = 600;\n\n  boxStrokeWidth = '2px';\n  boxFillOpacity = 0.35;\n  meanStrokeWidth = '4px';\n\n  labelFont = '12px';\n  labelFillOpacity = 0.35;\n  backLabelOpacity = 0.30;\n\n  backdropColor = 'white';\n  backdropOpacity = 1;\n\n  whiskerStrokeWidth = '1px';\n\n  outliersStrokeWidth = '1px';\n  outliersCircleRadius = 3;\n  outliersFillOpacity = 0.4;\n}\n\n\nexport let defualtLookAndFeel: () => LookAndFeel = function() {\n  return new LookAndFeel();\n};\n\nexport class GraphicContext {\n\n  /*transitionTime: number;\n\n   get transitionOn(): boolean {\n   return (this.transitionTime && this.transitionTime > 0);\n   };*/\n\n  transitionOn: boolean;\n  transition: Transition<any, any, any, any>;\n\n  workspaceWidth: number;\n  workspaceHeight: number;\n\n  axisWrapper: Selection<SVGGElement, any, null, undefined>;\n  xScale: ScaleLinear<number, number>;\n  xTopAxis: Axis<number | { valueOf(): number }>;\n  xBottomAxis: Axis<number | { valueOf(): number }>;\n\n  yScale: ScaleBand<string>;\n  yLeftAxis: Axis<string>;\n  yRightAxis: Axis<string>;\n\n  palette: string[];\n\n  dataWrapper: Selection<SVGGElement, any, null, undefined>;\n\n  tooltipWrapper: Selection<SVGGElement, any, null, undefined>;\n  tooltipText: Selection<SVGGElement, any, null, undefined>;\n  tooltipBox: Selection<SVGGElement, any, null, undefined>;\n\n  labelsWrapper: Selection<SVGGElement, any, null, undefined>;\n  backLabelsWrapper: Selection<SVGGElement, any, null, undefined>;\n  labelsTimers = [];\n}\n\nexport function offsetScaleValue(x: number, pixOffset: number, scale: ScaleLinear<number, number>) {\n  const r = scale.range();\n  const pos = scale(x) + pixOffset;\n  if (pos < r[0]) {\n    return r[0];\n  } else if (pos > r[1]) {\n    return r[1];\n  }\n  return pos;\n}\n\n\n\n","\nexport class BoxDefinition {\n  median: number;\n  mean: number;\n  fstQnt: number;\n  thrdQnt: number;\n  lowWskr: number;\n  highWskr: number;\n  outliers: number[] = [];\n  ix: number;\n  key: string;\n  label: string;\n  color: string;\n  hidden: boolean;\n}\n","import {BoxDefinition} from './box-dom';\nimport {d3} from '../d3service';\n\nexport class BoxUtil {\n\n  dataToBoxes(data: number[][]): BoxDefinition[] {\n    if (!data) {\n      return [];\n    }\n\n\n    return data.map((v, ix) => {\n      const b = this.datumToBox(v);\n      b.ix = ix;\n      b.key = (ix + 1) + '.';\n      return b;\n    });\n  }\n\n  datumToBox(data: number[]): BoxDefinition {\n\n    const box = new BoxDefinition();\n    if (!data || data.length === 0) {\n      return box;\n    }\n\n    data = data.sort(d3.ascending);\n    box.mean = d3.mean(data);\n    box.median = d3.median(data);\n    box.fstQnt = d3.quantile(data, 0.25);\n    box.thrdQnt = d3.quantile(data, 0.75);\n\n    const iqr = 1.5 * (box.thrdQnt - box.fstQnt);\n    box.lowWskr = box.fstQnt - iqr;\n    box.highWskr = box.thrdQnt + iqr;\n\n    for (let i = 0; i < data.length; i++) {\n      if (data[i] >= box.lowWskr) {\n        box.lowWskr = data[i];\n        break;\n      }\n    }\n\n    for (let i = data.length - 1; i >= 0; i--) {\n      if (data[i] <= box.highWskr) {\n        box.highWskr = data[i];\n        break;\n      }\n    }\n\n\n    box.outliers = data.filter(v => (v < box.lowWskr || v > box.highWskr));\n    return box;\n  }\n\n  mockEmptyValues(boxes: BoxDefinition[], missingVal: number) {\n    boxes.forEach(box => {\n      if (box.mean === undefined || box.mean === null) {\n        box.mean = missingVal;\n        box.median = missingVal;\n        box.fstQnt = missingVal;\n        box.thrdQnt = missingVal;\n        box.lowWskr = missingVal;\n        box.highWskr = missingVal;\n      }\n    });\n  }\n}\n","\r\nexport class BD2ColorPalette {\r\n\r\n  static schemeCategory10 = [\r\n    '#1f77b4',\r\n    '#ff7f0e',\r\n    '#2ca02c',\r\n    '#d62728',\r\n    '#9467bd',\r\n    '#8c564b',\r\n    '#e377c2',\r\n    '#7f7f7f',\r\n    '#bcbd22',\r\n    '#17becf'\r\n  ];\r\n\r\n  static schemeCategory20 = [\r\n'#1f77b4'\r\n, '#aec7e8'\r\n, '#ff7f0e'\r\n, '#ffbb78'\r\n, '#2ca02c'\r\n, '#98df8a'\r\n, '#d62728'\r\n, '#ff9896'\r\n, '#9467bd'\r\n, '#c5b0d5'\r\n, '#8c564b'\r\n, '#c49c94'\r\n, '#e377c2'\r\n, '#f7b6d2'\r\n, '#7f7f7f'\r\n, '#c7c7c7'\r\n, '#bcbd22'\r\n, '#dbdb8d'\r\n, '#17becf'\r\n, '#9edae5'];\r\n\r\n  static extendPalette(palette: string[] | ReadonlyArray<string>, size: number): string[] {\r\n\r\n    if (!palette || palette.length === 0) {\r\n      palette = ['black'];\r\n    }\r\n\r\n    const out = [];\r\n    for (let i = 0; i < size; i++) {\r\n      out.push(palette[i % palette.length]);\r\n    }\r\n    return out;\r\n\r\n  }\r\n\r\n  static palette(size: number): string[] {\r\n    // if (true) return BD2ColorPalette.extendPalette(['#1f77b4'], size);\r\n    if (size <= BD2ColorPalette.schemeCategory10.length) {\r\n      return BD2ColorPalette.extendPalette(BD2ColorPalette.schemeCategory10, size);\r\n    } else {\r\n      return BD2ColorPalette.extendPalette(BD2ColorPalette.schemeCategory20, size);\r\n    }\r\n\r\n  }\r\n}\r\n","\r\nexport class SmartRounder {\r\n\r\n  static round(value: number, base?: number): number {\r\n\r\n    base = base || value;\r\n    base = Math.abs(base);\r\n\r\n    if (base < 0.01) {\r\n      return value;\r\n    }\r\n\r\n    if (base < 1) {\r\n      return Math.round(value * 10000) / 10000;\r\n    }\r\n\r\n    if (base < 1000) {\r\n      return Math.round(value * 100) / 100;\r\n    }\r\n    return Math.round(value);\r\n  }\r\n\r\n\r\n}\r\n","import {\r\n  Component, OnInit, Input, AfterViewInit, OnChanges, OnDestroy, NgZone, ChangeDetectorRef,\r\n  ElementRef, SimpleChanges, ChangeDetectionStrategy, EventEmitter, Output\r\n} from '@angular/core';\r\nimport {D3, d3} from '../d3service';\r\n\r\nimport {Selection} from 'd3';\r\nimport {defualtLookAndFeel, GraphicContext, LookAndFeel, offsetScaleValue} from './hbox-plot.dom';\r\nimport {BoxDefinition} from '../hbox-utils/box-dom';\r\nimport {BoxUtil} from '../hbox-utils/box-util';\r\nimport {BD2ColorPalette} from '../hbox-utils/color-palette';\r\nimport {SmartRounder} from '../hbox-utils/smart-rounding';\r\n\r\n\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'bd2-ngx-hbox-plot',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  template: `\r\n    <div class=\"hbox-plot\" [hidden]=\"hidden\"></div>\r\n  `,\r\n  styles: [\r\n      `\r\n      :host /deep/ .axisWrapper path {\r\n        stroke: gray;\r\n      }\r\n\r\n      :host /deep/ .axisWrapper line {\r\n        stroke: gray;\r\n      }\r\n\r\n      :host /deep/ .axisWrapper text {\r\n        fill: gray;\r\n      }\r\n    `\r\n  ]\r\n})\r\nexport class HBoxPlotComponent implements OnInit, AfterViewInit, OnChanges, OnDestroy {\r\n\r\n  /**\r\n   * Necessary to control hiding of the element, otherwise the BBoxes are not defined and labels\r\n   * were not rendered in correct places.\r\n   *\r\n   */\r\n  @Input()\r\n  hidden = false;\r\n\r\n\r\n  @Input()\r\n  data: number[][];\r\n\r\n  @Input()\r\n  removed: number[] = [];\r\n\r\n  @Input()\r\n  domain: number[] = [17, 36];\r\n\r\n  @Input()\r\n  palette: string[] = [];\r\n\r\n  @Input()\r\n  labels: string[] = [];\r\n\r\n  @Input()\r\n  labelsOn = 'always'; // trigger //null\r\n\r\n  @Input()\r\n  lookAndFeel = defualtLookAndFeel();\r\n\r\n  @Input() // median, label, null\r\n  set sorted(sorting: string) {\r\n\r\n    if (sorting === 'median') {\r\n      this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => b1.median - b2.median;\r\n    } else if (sorting === 'label') {\r\n      // console.log(\"N\",navigator.language);\r\n      /*if (navigator.language) {\r\n       this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) =>\r\n       b1.label.localeCompare(b2.label, navigator.language, {sensitivity: 'case'});\r\n       } else {\r\n       this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => b1.label.localeCompare(b2.label);\r\n       };*/\r\n      this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => {\r\n        if (b1.label === b2.label) {\r\n          return 0;\r\n        }\r\n        if (b1.label < b2.label) {\r\n          return -1;\r\n        }\r\n        return 1;\r\n      };\r\n    } else {\r\n      this.sortFunction = (b1: BoxDefinition, b2: BoxDefinition) => b1.ix - b2.ix;\r\n    }\r\n  }\r\n\r\n\r\n  sortChanged = false;\r\n\r\n  @Output()\r\n  colors = new EventEmitter<string[]>();\r\n\r\n  private d3: D3;\r\n  private parentNativeElement: any;\r\n  private d3Svg: Selection<SVGSVGElement, any, null, undefined>;\r\n  // private removedSVG: Selection<SVGSVGElement, any, null, undefined>;\r\n\r\n  private mainPane: Selection<SVGGElement, any, null, undefined>;\r\n\r\n  private graphicContext = new GraphicContext();\r\n  private boxUtil = new BoxUtil();\r\n\r\n  sortFunction = function(b1: BoxDefinition, b2: BoxDefinition) {\r\n    return b1.ix - b2.ix;\r\n  };\r\n\r\n\r\n  constructor(private ngZone: NgZone, private changeDetectorRef: ChangeDetectorRef, element: ElementRef) {\r\n    this.d3 = d3;\r\n    this.parentNativeElement = element.nativeElement;\r\n\r\n  }\r\n\r\n  /**\r\n   * It is detached from angular to prevent unnecessary change detection\r\n   */\r\n  ngAfterViewInit() {\r\n    this.changeDetectorRef.detach();\r\n    // console.log(\"AFI\");\r\n  }\r\n\r\n  /**\r\n   * Explicit triggers re-drawing as need to have all the parameters set (so will not redrawn if data came frist and domain later)\r\n   * @param changes\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n\r\n    // console.log(\"Changes\", changes);\r\n\r\n    // otherwise the hidden on inner div was not updated\r\n    this.changeDetectorRef.detectChanges();\r\n\r\n\r\n    this.initSVG();\r\n\r\n    // this.handleHiding();\r\n\r\n    if (!this.data) {\r\n      return;\r\n    }\r\n\r\n    this.sortChanged = changes.sorted !== undefined;\r\n\r\n    if (!this.hidden) {\r\n      this.updatePlot();\r\n    }\r\n  }\r\n\r\n  isDataUpdate(changes: any): boolean {\r\n\r\n    return (changes.data || changes.removed || changes.domain || changes.palette || changes.labels );\r\n  }\r\n\r\n  initSVG() {\r\n    if (!this.d3Svg) {\r\n      const d3ParentElement = this.d3.select(this.parentNativeElement);\r\n      this.d3Svg = d3ParentElement.select('.hbox-plot').append<SVGSVGElement>('svg');\r\n      this.d3Svg.attr('width', '0');\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n    if (this.parentNativeElement !== null) {\r\n\r\n\r\n    } else {\r\n      console.error('Missing parrent element for the component');\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.d3Svg && this.d3Svg.empty && !this.d3Svg.empty()) {\r\n      this.d3Svg.selectAll('*').remove();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Only for testing\r\n   * @param context\r\n   */\r\n  testGraphicContext(context: GraphicContext) {\r\n    this.graphicContext = context;\r\n  }\r\n\r\n  /* Not needed any more, the hidding is achieved by simple div hidden attribute\r\n   // and the problem with labels background rendering is solved using delayed rendering with a timer.\r\n   handleHiding() {\r\n   if (this.hidden) {\r\n   this.removed = this.d3Svg.remove();\r\n   } else {\r\n   if (this.removed) {\r\n   this.d3.select(this.parentNativeElement)\r\n   .select('.hbox-plot')\r\n   .append(() => this.d3Svg.node());\r\n   this.removed = undefined;\r\n   }\r\n   }\r\n\r\n   }*/\r\n\r\n  updatePlot() {\r\n\r\n    // this.graphicContext.transitionTime = this.lookAndFeel.transitionTime;\r\n\r\n    if (this.lookAndFeel.transitionTime > 0) {\r\n      this.graphicContext.transitionOn = true;\r\n      this.ngZone.runOutsideAngular(() => {\r\n        this.graphicContext.transition = (this.d3 as any).transition().duration(this.lookAndFeel.transitionTime);\r\n      });\r\n    } else {\r\n      this.graphicContext.transitionOn = false;\r\n      this.graphicContext.transition = undefined;\r\n    }\r\n\r\n    this.graphicContext = this.updatePalette(this.data, this.palette, this.graphicContext);\r\n\r\n    let boxes = this.prepareDataModel(this.data, this.removed, this.labels, this.graphicContext.palette,\r\n      this.domain, this.sortFunction);\r\n\r\n    boxes = boxes.filter(b => !b.hidden);\r\n\r\n    this.graphicContext = this.preparePane(boxes, this.lookAndFeel, this.graphicContext);\r\n\r\n    this.graphicContext = this.prepareScales(boxes, this.domain, this.lookAndFeel, this.graphicContext);\r\n\r\n    this.graphicContext = this.plotAxisBox(boxes, this.domain, this.lookAndFeel, this.mainPane, this.graphicContext);\r\n\r\n\r\n    this.graphicContext = this.plotDataBoxes(boxes, this.lookAndFeel, this.mainPane, this.graphicContext);\r\n\r\n    this.graphicContext = this.prepareTooltip(this.mainPane, this.graphicContext);\r\n\r\n    this.graphicContext = this.prepareLabels(boxes, this.mainPane, this.lookAndFeel, this.graphicContext, this.labelsOn);\r\n\r\n  }\r\n\r\n  prepareDataModel(data: number[][], removed: number[], labels: string[], palette: string[], domain: number[],\r\n                   sortFunction: (b1: BoxDefinition, b2: BoxDefinition) => number): BoxDefinition[] {\r\n\r\n    let boxes = this.boxUtil.dataToBoxes(data);\r\n\r\n    this.boxUtil.mockEmptyValues(boxes, domain[1]);\r\n    this.labelBoxes(boxes, labels);\r\n\r\n    this.colorBoxes(boxes, palette);\r\n\r\n    removed.forEach(ix => {\r\n      if (boxes[ix]) {\r\n        boxes[ix].hidden = true;\r\n      }\r\n    });\r\n\r\n    boxes = boxes.sort(sortFunction);\r\n    return boxes;\r\n\r\n  }\r\n\r\n\r\n  updatePalette(data: any[], palette: string[], graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!palette || palette.length === 0) {\r\n      graphicContext.palette = BD2ColorPalette.palette(data.length);\r\n    } else {\r\n      graphicContext.palette = BD2ColorPalette.extendPalette(palette, data.length);\r\n\r\n    }\r\n    this.colors.next(graphicContext.palette.slice());\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  colorBoxes(boxes: BoxDefinition[], palette: string[]) {\r\n    boxes.forEach(b => b.color = palette[b.ix]);\r\n  }\r\n\r\n\r\n  preparePane(data: any[], lookAndFeel: LookAndFeel, graphicContext: GraphicContext): GraphicContext {\r\n\r\n    // console.log(\"PP\",data);\r\n\r\n    if (!this.mainPane) {\r\n      // let d3ParentElement = this.d3.select(this.parentNativeElement);\r\n      // this.d3Svg = d3ParentElement.select('.hbox-plot').append<SVGSVGElement>('svg');\r\n      this.d3Svg.attr('width', '100%');\r\n\r\n      this.mainPane = this.d3Svg.append<SVGGElement>('g');\r\n      this.mainPane.classed('mainPane', true);\r\n\r\n    }\r\n\r\n    const pWidth = 500;\r\n    const pHeight = this.calculateWorkspaceHeight(data, lookAndFeel) + 2 * lookAndFeel.vMargin;\r\n\r\n    const elm = (graphicContext.transitionOn ? this.d3Svg.transition(graphicContext.transition) : this.d3Svg);\r\n    elm.attr('viewBox', '0 0 ' + pWidth + ' ' + pHeight);\r\n    this.mainPane.attr('transform', 'translate(' + lookAndFeel.hMarginL + ',' + lookAndFeel.vMargin + ')');\r\n    // .attr('transform', 'translate(' + (pWidth / 2) + ',' + (pHeight / 2) + ')'); //moves 0,0 of the pain to the middle of the graphics\r\n\r\n    graphicContext.workspaceWidth = pWidth - lookAndFeel.hMarginL - lookAndFeel.hMarginR;\r\n    graphicContext.workspaceHeight = pHeight - 2 * lookAndFeel.vMargin;\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n  calculateWorkspaceHeight(data: any[], lookAndFeel: LookAndFeel) {\r\n    return lookAndFeel.rowWidth * data.length;\r\n\r\n  }\r\n\r\n\r\n  labelBoxes(boxes: BoxDefinition[], labels: string[]) {\r\n    if (!labels) {\r\n      labels = [];\r\n    }\r\n\r\n\r\n    boxes.forEach((b, ix) => {\r\n      b.label = labels[ix] ? labels[ix] : '' + (ix + 1);\r\n    });\r\n  }\r\n\r\n  prepareLabels(boxes: BoxDefinition[], mainPane: Selection<SVGGElement, any, null, undefined>, lookAndFeel: LookAndFeel,\r\n                graphicContext: GraphicContext, labelsOn: string): GraphicContext {\r\n\r\n    if (!graphicContext.labelsWrapper) {\r\n      graphicContext.labelsWrapper = mainPane.append<SVGGElement>('g')\r\n        .classed('labelsWrapper', true);\r\n    }\r\n\r\n    if (!graphicContext.backLabelsWrapper) {\r\n      graphicContext.backLabelsWrapper = mainPane.insert<SVGGElement>('g', 'g.dataWrapper')\r\n        .classed('backLabelsWrapper', true);\r\n    }\r\n\r\n    const backLabelsOn = labelsOn === 'always';\r\n    const mainLabelsOn = labelsOn === 'always' || labelsOn === 'trigger';\r\n\r\n\r\n    const labels = graphicContext.labelsWrapper.selectAll('g.yLabel')\r\n      .data(mainLabelsOn ? boxes : [], (d: BoxDefinition) => d.key);\r\n\r\n    labels.exit().remove();\r\n\r\n    const newLabels = labels.enter()\r\n      .append<SVGGElement>('g')\r\n      .classed('yLabel', true);\r\n\r\n    this.ngZone.runOutsideAngular(() => {\r\n      newLabels.on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n        d3.select(this)\r\n          .selectAll('.yLabel')\r\n          // .style(\"visibility\", \"visible\");\r\n          .style('display', null);\r\n      }).on('mouseout', function() {\r\n        d3.select(this)\r\n          .selectAll('.yLabel')\r\n          // .style(\"visibility\", \"hidden\");\r\n          .style('display', 'none');\r\n      });\r\n    });\r\n\r\n    newLabels.append<SVGGElement>('rect')\r\n      .attr('class', 'yTrigger')\r\n      .style('fill-opacity', 1)\r\n    ;\r\n\r\n    newLabels.append<SVGGElement>('rect')\r\n      .attr('class', 'yLabel')\r\n      .style('fill-opacity', 0.35)\r\n      // .style(\"visibility\", \"hidden\");\r\n      .style('display', 'none');\r\n\r\n\r\n    newLabels.append<SVGGElement>('text')\r\n      .attr('class', 'yLabel')\r\n      .attr('text-anchor', 'left')\r\n      .attr('dominant-baseline', 'central')\r\n      .style('font-size', lookAndFeel.labelFont)\r\n      .style('opacity', 1)\r\n      .attr('x', 5)\r\n    // .style(\"visibility\", \"hidden\");\r\n    // .style(\"display\", \"none\");\r\n    ;\r\n\r\n    const backLabels = graphicContext.backLabelsWrapper.selectAll('g.yLabel')\r\n      .data(backLabelsOn ? boxes : [], (d: BoxDefinition) => d.key);\r\n\r\n    backLabels.exit().remove();\r\n\r\n    const newBackLabels = backLabels.enter()\r\n      .append<SVGGElement>('g')\r\n      .classed('yLabel', true);\r\n\r\n    /*\r\n     newBackLabels.append<SVGGElement>(\"rect\")\r\n     .attr(\"class\", \"yLabel\")\r\n     .style(\"fill-opacity\", 0.05);\r\n     */\r\n\r\n    newBackLabels.append<SVGGElement>('text')\r\n      .attr('class', 'yLabel')\r\n      .attr('text-anchor', 'left')\r\n      .attr('dominant-baseline', 'central')\r\n      .style('font-size', lookAndFeel.labelFont)\r\n      .style('opacity', lookAndFeel.backLabelOpacity)\r\n      .attr('x', 5);\r\n    // .style(\"visibility\", \"hidden\");\r\n\r\n\r\n    const enterUpdate: Selection<SVGSVGElement, BoxDefinition, null, undefined> =\r\n      newLabels.merge(labels as any) as Selection<SVGSVGElement, BoxDefinition, null, undefined>;\r\n\r\n    const backEnterUpdate: Selection<SVGSVGElement, BoxDefinition, null, undefined> =\r\n      newBackLabels.merge(backLabels as any) as Selection<SVGSVGElement, BoxDefinition, null, undefined>;\r\n\r\n    // called with delay to allow, parent divs to component sets their visibility, otherwise the bboxes cannot be calculated\r\n    // and the labels backgrounds and trigers are not rendered correctly\r\n    // it is a hack, but don't know how to do it correctly\r\n    // timers have to be cleared as otherwise saw errors in logs for fast changing input data (like cause by sorting and pagination)\r\n    graphicContext.labelsTimers.forEach( timer => clearTimeout(timer));\r\n    graphicContext.labelsTimers = [];\r\n    const timer = setTimeout(() => {\r\n\r\n\r\n      const bboxes: SVGRect[] = [];\r\n\r\n      enterUpdate.select<SVGSVGElement>('text')\r\n        .style('display', null)\r\n        .attr('y', d => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n        .text(d => d.label)\r\n        .each(function(d) {\r\n          bboxes.push(this.getBBox());\r\n          // console.log(\"D: \" + d.label, this.getBBox());\r\n        })\r\n        .style('display', 'none');\r\n\r\n\r\n      let elm = backEnterUpdate.select<SVGSVGElement>('text');\r\n      elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n      elm\r\n        .attr('y', d => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n        .text(d => d.label)\r\n      // .style(\"fill\", d => d.color)\r\n      /*.each(function (d) {\r\n       bboxes.push(this.getBBox());\r\n       //console.log(\"D: \" + d.label, this.getBBox());\r\n       });*/\r\n      ;\r\n\r\n      const trigers = enterUpdate.select<SVGSVGElement>('.yTrigger')\r\n        .style('fill', d => d.color)\r\n        .style('stroke', d => d.color);\r\n\r\n\r\n      let telm = trigers.data(bboxes);\r\n      telm = (graphicContext.transitionOn ? telm.transition(graphicContext.transition) : telm) as any;\r\n      telm\r\n        .attr('x', -7)\r\n        .attr('y', b => b.y - 3)\r\n        .attr('width', b => 7)\r\n        .attr('height', b => b.height + 6);\r\n\r\n      const frames = enterUpdate.select<SVGSVGElement>('rect.yLabel')\r\n        .style('fill', d => d.color)\r\n        .style('fill-opacity', lookAndFeel.labelFillOpacity);\r\n\r\n      frames.data(bboxes)\r\n        .attr('x', 0)\r\n        .attr('y', b => b.y - 3)\r\n        .attr('width', b => b.width + 10)\r\n        .attr('height', b => b.height + 7);\r\n\r\n\r\n      /*\r\n       let backFrames = backEnterUpdate.select<SVGSVGElement>(\"rect.yLabel\")\r\n       .style(\"fill\", d => d.color);\r\n\r\n       backFrames.data(bboxes)\r\n       .attr(\"x\", 0)\r\n       .attr(\"y\", b => b.y - 3)\r\n       .attr(\"width\", b => b.width + 10)\r\n       .attr(\"height\", b => b.height + 7);\r\n       */\r\n\r\n    }, 10);\r\n\r\n    graphicContext.labelsTimers.push(timer);\r\n    return graphicContext;\r\n  }\r\n\r\n\r\n  prepareTooltip(mainPane: Selection<SVGGElement, any, null, undefined>, graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (graphicContext.tooltipWrapper) {\r\n      return graphicContext;\r\n    }\r\n\r\n    graphicContext.tooltipWrapper = mainPane.append<SVGGElement>('g')\r\n      .classed('tooltipWrapper', true);\r\n\r\n    graphicContext.tooltipBox = graphicContext.tooltipWrapper.append<SVGGElement>('rect')\r\n      .style('fill', 'white')\r\n      .style('fill-opacity', 0.8)\r\n      .style('stroke', 'grey')\r\n    // .style(\"visibility\", \"hidden\");\r\n    ;\r\n\r\n    graphicContext.tooltipText = graphicContext.tooltipWrapper.append<SVGGElement>('text')\r\n      .attr('class', 'tooltip')\r\n      // .attr(\"text-anchor\", \"left\")\r\n      .attr('text-anchor', 'middle')\r\n      // .attr(\"alignment-baseline\", \"middle\")\r\n      // .attr(\"alignment-baseline\", \"baseline\")\r\n      // .attr(\"dy\", \"-10px\")\r\n      .style('opacity', 1)\r\n    // .attr(\"dx\", \"0.35em\")\r\n    // .style(\"font-size\", this.lookAndFeel.tooltipFontSize) //\"11px\")\r\n    // .style(\"opacity\", 0)\r\n    ;\r\n\r\n    graphicContext.tooltipWrapper\r\n    // .style(\"visibility\", \"hidden\");\r\n      .style('display', 'none');\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  showTooltip(v: number, x: any, y: any) {\r\n    // console.log(\"Show: \" + v + \";\" + this.constructor.name);\r\n    // console.log('Show: ' + v + '; ' + x + ': ' + y);\r\n    // console.log('v', SmartRounder.round(v));\r\n    // console.log('x', this.graphicContext.xScale(x));\r\n    // console.log('y', this.graphicContext.yScale(y));\r\n\r\n    if (!this.graphicContext.tooltipText) {\r\n      return;\r\n    }\r\n\r\n    this.graphicContext.tooltipText\r\n      .attr('x', this.graphicContext.xScale(x))\r\n      .attr('y', this.graphicContext.yScale(y))\r\n      .text(SmartRounder.round(v))\r\n    // .transition().duration(this.lookAndFeel.baseTransitionsTime / 2)\r\n    // .style('opacity', 1);\r\n    ;\r\n\r\n    // I have to change the display here even before the box is ready as\r\n    // in firefox the getBBox was not working if called with display none\r\n    // giving NS_ERROR_FAILURE 2147500037\r\n    this.graphicContext.tooltipWrapper\r\n      // .style(\"visibility\", \"visible\");\r\n      .style('display', null);\r\n\r\n    const bbox = this.graphicContext.tooltipText.node().getBBox();\r\n\r\n    this.graphicContext.tooltipBox\r\n      .attr('x', bbox.x - 3)\r\n      .attr('y', bbox.y - 2)\r\n      .attr('width', bbox.width + 6)\r\n      .attr('height', bbox.height + 4);\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n  hideTooltip() {\r\n    // console.log(\"Hide: \");\r\n    if (!this.graphicContext.tooltipText) {\r\n      return;\r\n    }\r\n\r\n\r\n    this.graphicContext.tooltipWrapper\r\n    // .style(\"visibility\", \"hidden\");\r\n      .style('display', 'none');\r\n\r\n\r\n    // this.graphicContext.tooltipText\r\n    // .transition().duration(this.lookAndFeel.baseTransitionsTime / 2)\r\n    // .style(\"opacity\", 0);\r\n  }\r\n\r\n  prepareScales(data: BoxDefinition[], domain: number[], lookAndFeel: LookAndFeel,\r\n                graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!graphicContext.xScale) {\r\n      graphicContext.xScale = d3.scaleLinear()\r\n        .clamp(true);\r\n    }\r\n\r\n    graphicContext.xScale\r\n      .domain(domain)\r\n      .range([0, graphicContext.workspaceWidth]);\r\n\r\n    if (!graphicContext.yScale) {\r\n      graphicContext.yScale = d3.scaleBand()\r\n        .padding(lookAndFeel.rowGap)\r\n      ;\r\n    }\r\n\r\n    const domainY = data.map((d) => d.key);\r\n\r\n    graphicContext.yScale\r\n      .domain(domainY)\r\n      .range([0, graphicContext.workspaceHeight]);\r\n\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  plotAxisBox(data: BoxDefinition[], domain: number[], lookAndFeel: LookAndFeel, mainPane: Selection<SVGGElement, any, null, undefined>,\r\n              graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!graphicContext.axisWrapper) {\r\n      graphicContext.axisWrapper = this.initAxisWrapper(mainPane);\r\n    }\r\n\r\n    graphicContext = this.plotHorizontalScales(domain, lookAndFeel, graphicContext);\r\n    graphicContext = this.plotVerticalScales(data, lookAndFeel, graphicContext);\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n  initAxisWrapper(mainPane: Selection<SVGGElement, any, null, undefined>): Selection<SVGGElement, any, null, undefined> {\r\n\r\n    let wrapper = mainPane.select<SVGGElement>('.axisWrapper');\r\n    if (wrapper.size() === 0) {\r\n      wrapper = mainPane.append<SVGGElement>('g').attr('class', 'axisWrapper');\r\n\r\n      wrapper.append('g').attr('class', 'xTopAxis');\r\n      wrapper.append('g').attr('class', 'xBottomAxis');\r\n      wrapper.append('g').attr('class', 'yLeftAxis');\r\n      wrapper.append('g').attr('class', 'yRightAxis');\r\n\r\n    }\r\n    return wrapper;\r\n  }\r\n\r\n  plotHorizontalScales(domain: number[], lookAndFeel: LookAndFeel, graphicContext: GraphicContext): GraphicContext {\r\n\r\n\r\n    if (!graphicContext.xTopAxis) {\r\n      graphicContext.xTopAxis = d3.axisTop(graphicContext.xScale);\r\n    }\r\n\r\n    if (!graphicContext.xBottomAxis) {\r\n      graphicContext.xBottomAxis = d3.axisBottom(graphicContext.xScale);\r\n    }\r\n\r\n\r\n    graphicContext.axisWrapper\r\n      .select('g.xTopAxis')\r\n      .call(graphicContext.xTopAxis);\r\n\r\n    let elm = graphicContext.axisWrapper.select('g.xBottomAxis') as any;\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm);\r\n    elm\r\n      .attr('transform', 'translate(0,' + graphicContext.workspaceHeight + ')')\r\n      .call(graphicContext.xBottomAxis);\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n  plotVerticalScales(data: BoxDefinition[], lookAndFeel: LookAndFeel, graphicContext: GraphicContext): GraphicContext {\r\n\r\n\r\n    if (!graphicContext.yLeftAxis) {\r\n      graphicContext.yLeftAxis = d3.axisLeft(graphicContext.yScale)\r\n        .tickFormat(() => '')\r\n      ;\r\n    }\r\n\r\n    if (!graphicContext.yRightAxis) {\r\n      graphicContext.yRightAxis = d3.axisRight(graphicContext.yScale)\r\n        .tickValues([])\r\n      ;\r\n    }\r\n\r\n    let elm = graphicContext.axisWrapper.select('g.yLeftAxis') as any;\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm);\r\n    elm\r\n      .call(graphicContext.yLeftAxis);\r\n\r\n\r\n    elm = graphicContext.axisWrapper.select('g.yRightAxis')\r\n      .attr('transform', 'translate(' + graphicContext.workspaceWidth + ',0)') as any;\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm);\r\n    elm\r\n      .call(graphicContext.yRightAxis);\r\n\r\n    return graphicContext;\r\n\r\n  }\r\n\r\n\r\n  plotDataBoxes(boxes: BoxDefinition[], lookAndFeel: LookAndFeel, mainPane: Selection<SVGGElement, any, null, undefined>,\r\n                graphicContext: GraphicContext): GraphicContext {\r\n\r\n    if (!graphicContext.dataWrapper) {\r\n      graphicContext.dataWrapper = mainPane.append<SVGGElement>('g').attr('class', 'dataWrapper');\r\n    }\r\n\r\n\r\n\r\n    let boxWidgets = graphicContext.dataWrapper.selectAll('.boxWidget') as Selection<SVGGElement, BoxDefinition, null, undefined>;\r\n\r\n    boxWidgets = boxWidgets.data(boxes, d => d.key);\r\n\r\n\r\n    this.updateBoxWidgets(boxWidgets, lookAndFeel, graphicContext);\r\n\r\n    const newBoxWidgets = boxWidgets.enter()\r\n      .append<SVGGElement>('g').attr('class', 'boxWidget');\r\n\r\n\r\n    this.createBoxWidgets(newBoxWidgets, lookAndFeel, graphicContext);\r\n\r\n    boxWidgets.exit().remove();\r\n\r\n\r\n    return graphicContext;\r\n  }\r\n\r\n  updateBoxWidgets(boxWidgets: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                   lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n    // this.ngZone.runOutsideAngular(() => {\r\n\r\n    boxWidgets.select('rect.backdrop')\r\n      .call(this.positionBackdrop, graphicContext);\r\n\r\n    this.updateWhiskers(boxWidgets.select('g.whiskers') as any, graphicContext);\r\n\r\n    boxWidgets.select('g.box rect')\r\n      .call(this.positionBoxRectangle, graphicContext);\r\n\r\n    boxWidgets.select('g.box line.medianline')\r\n      .call(this.positionMedianLine, graphicContext);\r\n\r\n    boxWidgets.select('g.box line.meanline')\r\n      .call(this.positionMeanLine, graphicContext);\r\n\r\n    const out = boxWidgets.select('g.outliers').selectAll('.outlier')\r\n      .data(d => d.outliers.map(x => [x, d.key, d.color]));\r\n\r\n    out.enter()\r\n      .call(this.createOutlier, lookAndFeel, graphicContext, this.positionOutlier);\r\n\r\n    out.call(this.positionOutlier, graphicContext);\r\n\r\n    out.exit().remove();\r\n\r\n    // });\r\n\r\n  }\r\n\r\n\r\n  positionBackdrop(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x', (d) => offsetScaleValue(d.lowWskr, -5, graphicContext.xScale))\r\n      .attr('y', (d) => {\r\n        return graphicContext.yScale(d.key);\r\n      })\r\n      .attr('width', (d) => {\r\n        const x1 = offsetScaleValue(d.lowWskr, -5, graphicContext.xScale);\r\n        const x2 = offsetScaleValue(d.highWskr, +5, graphicContext.xScale);\r\n        return x2 - x1;\r\n      })\r\n      .attr('height', (d) => {\r\n        return graphicContext.yScale.bandwidth();\r\n      })\r\n    // .style(\"stroke\", d => d.color)\r\n    // .style(\"fill\", d => d.color)\r\n    ;\r\n\r\n  }\r\n\r\n  positionBoxRectangle(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x', (d) => graphicContext.xScale(d.fstQnt))\r\n      .attr('y', (d) => {\r\n        return graphicContext.yScale(d.key);\r\n      })\r\n      .attr('width', (d) => (graphicContext.xScale(d.thrdQnt) - graphicContext.xScale(d.fstQnt)))\r\n      .attr('height', (d) => {\r\n        return graphicContext.yScale.bandwidth();\r\n      })\r\n      .style('stroke', d => d.color)\r\n      .style('fill', d => d.color);\r\n\r\n  }\r\n\r\n  positionMedianLine(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => graphicContext.xScale(d.median))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key))\r\n      .attr('x2', (d, i) => graphicContext.xScale(d.median))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth())\r\n      .style('stroke', d => d.color)\r\n      // .style(\"visibility\", d => d.mean === d.median ? \"hidden\" : \"visible\");\r\n      .style('display', d => d.mean === d.median ? 'none' : null);\r\n\r\n\r\n\r\n  }\r\n\r\n  positionMeanLine(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => graphicContext.xScale(d.mean))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key))\r\n      .attr('x2', (d, i) => graphicContext.xScale(d.mean))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth())\r\n      .style('stroke', d => d.color);\r\n  }\r\n\r\n  positionOutlier(elm: Selection<SVGGElement, any, null, undefined>, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm.attr('cx', d => graphicContext.xScale(d[0]))\r\n      .attr('cy', d => graphicContext.yScale(d[1]) + graphicContext.yScale.bandwidth() / 2)\r\n      .style('stroke', d => d[2])\r\n      .style('fill', d => d[2]);\r\n\r\n  }\r\n\r\n\r\n  createOutlier(elm: Selection<SVGGElement, any, null, undefined>, lookAndFeel: LookAndFeel, graphicContext: GraphicContext,\r\n                positionOutlierFunction: (elm: Selection<SVGGElement, any, null, undefined>, graphicContext: GraphicContext) => {}) {\r\n\r\n\r\n    elm\r\n      .append<SVGGElement>('circle')\r\n      .attr('class', 'outlier')\r\n      .attr('r', lookAndFeel.outliersCircleRadius)\r\n      .style('stroke-width', lookAndFeel.outliersStrokeWidth)\r\n      .style('fill-opacity', lookAndFeel.outliersFillOpacity)\r\n      .call(positionOutlierFunction, graphicContext)\r\n    ;\r\n\r\n  }\r\n\r\n  positionWhiskerLine(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, left: boolean, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => left ? graphicContext.xScale(d.lowWskr) : graphicContext.xScale(d.thrdQnt))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n      .attr('x2', (d, i) => left ? graphicContext.xScale(d.fstQnt) : graphicContext.xScale(d.highWskr))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth() / 2)\r\n      .style('stroke', d => d.color)\r\n      // .style(\"visibility\", d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? \"hidden\" : \"visible\");\r\n      .style('display', d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? 'none' : null);\r\n\r\n\r\n  }\r\n\r\n  positionWhiskerTip(elm: Selection<SVGGElement, BoxDefinition, null, undefined>, left: boolean, graphicContext: GraphicContext) {\r\n\r\n    elm = (graphicContext.transitionOn ? elm.transition(graphicContext.transition) : elm) as any;\r\n    elm\r\n      .attr('x1', (d, i) => left ? graphicContext.xScale(d.lowWskr) : graphicContext.xScale(d.highWskr))\r\n      .attr('y1', (d, i) => graphicContext.yScale(d.key))\r\n      .attr('x2', (d, i) => left ? graphicContext.xScale(d.lowWskr) : graphicContext.xScale(d.highWskr))\r\n      .attr('y2', (d, i) => graphicContext.yScale(d.key) + graphicContext.yScale.bandwidth())\r\n      .style('stroke', d => d.color)\r\n      // .style(\"visibility\", d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? \"hidden\" : \"visible\");\r\n      .style('display', d => (left && (d.lowWskr === d.fstQnt)) || (!left && (d.highWskr === d.thrdQnt)) ? 'none' : null);\r\n\r\n\r\n\r\n  }\r\n\r\n  updateWhiskers(whiskers: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                 graphicContext: GraphicContext) {\r\n\r\n    whiskers.select('line.whiskerlineL')\r\n      .call(this.positionWhiskerLine, true, graphicContext);\r\n\r\n    whiskers.select('line.whiskerlineR')\r\n      .call(this.positionWhiskerLine, false, graphicContext);\r\n\r\n    whiskers.select('line.whiskertipL')\r\n      .call(this.positionWhiskerTip, true, graphicContext);\r\n\r\n    whiskers.select('line.whiskertipR')\r\n      .call(this.positionWhiskerTip, false, graphicContext);\r\n\r\n  }\r\n\r\n  createWhiskers(whiskers: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                 lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n\r\n    const lwhiskr = whiskers.append('line')\r\n      .attr('class', 'whiskerlineL')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .style('stroke-dasharray', '4 3')\r\n      .call(this.positionWhiskerLine, true, graphicContext)\r\n    ;\r\n    const rwhiskr = whiskers.append('line')\r\n      .attr('class', 'whiskerlineR')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .style('stroke-dasharray', '4 3')\r\n      .call(this.positionWhiskerLine, false, graphicContext)\r\n    ;\r\n\r\n    const lTip = whiskers.append('line')\r\n      .attr('class', 'whiskertipL')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .call(this.positionWhiskerTip, true, graphicContext)\r\n    ;\r\n\r\n    const rTip = whiskers.append('line')\r\n      .attr('class', 'whiskertipR')\r\n      .style('stroke-width', lookAndFeel.whiskerStrokeWidth)\r\n      .call(this.positionWhiskerTip, false, graphicContext)\r\n    ;\r\n\r\n\r\n  }\r\n\r\n  createBoxes(widgets: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n              lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n\r\n    const rect = widgets.append('rect')\r\n      .attr('class', 'box')\r\n      .style('stroke-width', lookAndFeel.boxStrokeWidth)\r\n      .style('fill-opacity', lookAndFeel.boxFillOpacity)\r\n      .call(this.positionBoxRectangle, graphicContext);\r\n\r\n\r\n    const median = widgets.append('line')\r\n      .attr('class', 'medianline')\r\n      .style('stroke-width', lookAndFeel.boxStrokeWidth)\r\n      .call(this.positionMedianLine, graphicContext);\r\n\r\n    const instance = this;\r\n\r\n    this.ngZone.runOutsideAngular(() => {\r\n      rect.on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n        instance.showTooltip(d.median, d.median, d.key);\r\n      })\r\n        .on('mouseout', function() {\r\n          instance.hideTooltip();\r\n        });\r\n\r\n      median.on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n        instance.showTooltip(d.median, d.median, d.key);\r\n      })\r\n        .on('mouseout', function() {\r\n          instance.hideTooltip();\r\n        });\r\n\r\n    });\r\n\r\n    const mean = widgets\r\n      .append('line')\r\n      .attr('class', 'meanline')\r\n      .style('stroke-width', lookAndFeel.meanStrokeWidth)\r\n      .style('stroke-dasharray', '4 2')\r\n      .call(this.positionMeanLine, graphicContext)\r\n    ;\r\n\r\n    // has to be outside angular, to prevent detection\r\n    this.ngZone.runOutsideAngular(() => {\r\n      mean\r\n        .on('mouseover', function(evnt: MouseEvent, d: BoxDefinition) {\r\n          instance.showTooltip(d.mean, d.mean, d.key);\r\n        })\r\n        .on('mouseout', function() {\r\n          instance.hideTooltip();\r\n        });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  createBoxWidgets(newBoxWidgets: Selection<SVGGElement, BoxDefinition, null, undefined>,\r\n                   lookAndFeel: LookAndFeel, graphicContext: GraphicContext) {\r\n\r\n    // this.ngZone.runOutsideAngular(() => {\r\n\r\n    const instance = this;\r\n\r\n    const backdrops = newBoxWidgets.append<SVGGElement>('rect').attr('class', 'backdrop')\r\n    // .style(\"stroke-width\", lookAndFeel.boxStrokeWidth)\r\n      .style('fill-opacity', lookAndFeel.backdropOpacity)\r\n      .style('fill', lookAndFeel.backdropColor)\r\n      .call(this.positionBackdrop, graphicContext);\r\n\r\n\r\n    const whiskers = newBoxWidgets.append<SVGGElement>('g').attr('class', 'whiskers');\r\n\r\n    this.createWhiskers(whiskers, lookAndFeel, graphicContext);\r\n\r\n    const boxes = newBoxWidgets.append<SVGGElement>('g').attr('class', 'box');\r\n    this.createBoxes(boxes, lookAndFeel, graphicContext);\r\n\r\n\r\n    const outliers = newBoxWidgets.append<SVGGElement>('g').attr('class', 'outliers');\r\n\r\n\r\n    outliers.selectAll('.outlier')\r\n      .data(d => d.outliers.map(x => [x, d.key, d.color]))\r\n      .enter()\r\n      .call(this.createOutlier, lookAndFeel, graphicContext, this.positionOutlier)\r\n    ;\r\n\r\n    // });\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\nimport {HBoxPlotComponent} from './hbox-plot/hbox-plot.component';\n\n\n\n@NgModule({\n  declarations: [HBoxPlotComponent],\n  imports: [\n  ],\n  exports: [HBoxPlotComponent]\n})\nexport class BD2NgxHBoxplotModule { }\n","/*\n * Public API Surface of bd2-ngx-hboxplot\n */\n\nexport * from './lib/hbox-plot/hbox-plot.component';\nexport * from './lib/bd2-ngx-hboxplot.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}